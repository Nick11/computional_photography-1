\documentclass{paper}


\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

\usepackage{color}
\usepackage{subcaption}
\usepackage{caption}




\usepackage{mathrsfs}
\usepackage{algpseudocode}
\usepackage{algorithm}

\usepackage{float}
\usepackage{mathtools}
\usepackage{mdwlist}
\usepackage{gensymb}
\usepackage{array}
\usepackage{multirow}
\usepackage[hmargin=3cm]{geometry}
\usepackage{boxedminipage}
\usepackage{enumerate}


\setlength{\parindent}{0pt}
\setlength{\parskip}{18pt}


\usepackage[latin1]{inputenc} 
\usepackage[T1]{fontenc} 

\usepackage{listings} 
\lstset{% 
   language=Matlab, 
   basicstyle=\small\ttfamily, 
} 






\renewcommand{\algorithmicforall}{\textbf{Foreach}}
\newcommand{\init}{\textbf{INIT }}
\newcommand{\pluseq}{\mathrel{+}=}
\newcommand{\asteq}{\mathrel{*}=}
\newcommand{\myto}{\textbf{TO }}
\newcommand*\colvec[3][]{
    \begin{pmatrix}\ifx\relax#1\relax\else#1\\\fi#2\\#3\end{pmatrix}
}
\newcommand{\myparagraph}[1]{\paragraph{#1}\mbox{}\\}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}



\title{Computational Photography Assignment 3}



\author{Single Michael\\08-917-445}
% //////////////////////////////////////////////////


\begin{document}



\maketitle


\section*{Task 1}

\paragraph{Def(Linear)} Given two measurable function $f$ and $g$ and $\alpha$, $\beta \in \mathbb{C}$. An operator $\mathcal{F}$ is called $\emph{linear}$ if the following identity holds true: \\
\begin{equation}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x) = \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\label{eq:lin_op}
\end{equation}

\paragraph{Def(Shift Invariant)} Given a measurable function $f$. An operator $\mathcal{F}$ is called $\emph{shift invariant}$ if the following identity holds true: \\
\begin{equation}
    \mathcal{F} \left \{S_\delta f \right\} (x) = S_\delta(\mathcal{F}\left \{f \right\})(x)
\label{eq:shift_inv_op}
\end{equation}

where the shift operator $S_{\delta}$ is defined as the following: 

\begin{equation}
    S_{\delta}(f)(x) = f(x+\delta)
\label{eq:shift_op}
\end{equation}

For any given function $f$ and small number $\delta \in \mathbb{R}$. \\

Note that notational convention the operation notion for any operator $F$, we write $F(f)(x)$ instead of $F(f(x))$. In words we apply the operator F (i.e. the functional F) to the function $f$. Thus is would even be possible to omit the argument $x$. However to make the reasoning clear, I will keep it. \\

Therefore, directly applying the definition from equation $\ref{eq:shift_op}$ to equation $\ref{eq:shift_inv_op}$ we can also define the property $\emph{shift invariant}$ as the follwoing:

\begin{equation}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} := \mathcal{F} \left\{ f(x+\delta) \right\} = S_\delta(\mathcal{F}\left \{f \right\}(x)
\label{eq:shift_inv_op_easy}
\end{equation}

Relying on the definitions of the equations before, equation $\ref{eq:shift_inv_op_easy}$ and equation $\ref{eq:lin_op}$ let I solved this task,

\begin{enumerate}[(a)] 

% a)
\item $\mathcal{F} \left \{ f \right\} (x) = e^{f(x)}$ is $\emph{not linear}$ and is $\emph{shift invariant}$. 

\paragraph{Show:} $\mathcal{F}$ is not \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x) 
    &= e^{\alpha f(x) + \beta g(x)} \\
    &= e^{\alpha f(x)} e^{\beta g(x)}\\
    &\neq \alpha e^{f(x)} + \beta e^{g(x)}\\
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= e^{f(x + \delta)} \\
    &= S_{\delta}(e^{f(x)}) \\
    &= S_\delta(\mathcal{F}\left \{f \right\}(x)
\end{align*}
\end{proof}


% b)
\item $\mathcal{F} \left \{ f \right\} (x) = f(x)f(x-1)$ is $\emph{not linear}$ and is $\emph{shift invariant}$.

\paragraph{Show} $\mathcal{F}$ is not \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x)
    &= (\alpha f(x) + \beta g(x))(\alpha f(x-1) + \beta g(x-1)) \\
    &= \alpha^2 f(x)f(x-1) + \beta^2 g(x)g(x-1) + \alpha \beta (f(x)g(x-1)+f(x-1)g(x)) \\
    &\neq \alpha f(x)f(x-1) + \beta g(x)g(x-1) \\
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= f(x+\delta)f(x-1+\delta) \\
    &= S_{\delta}(f(x)f(x-1)) \\
    &= S_\delta(\mathcal{F}\left \{f \right\}(x)
\end{align*}
\end{proof}

% c)
\item $\mathcal{F} \left \{ f \right\} (x) = \sum_{k=x-4}^{x+2}f(k)$ is $\emph{linear}$ and is $\emph{shift invariant}$.

\paragraph{Show} $\mathcal{F}$ is \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x)
    &= \sum_{k=x-4}^{x+2}(\alpha f(k) + \beta g(k)) \\
    &= \alpha \sum_{k=x-4}^{x+2} f(k) + \beta \sum_{k=x-4}^{x+2} g(k) \\
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= \sum_{k=x-4+\delta}^{x+2+\delta} f(k) \\
    &= \sum_{k=x-4}^{x+2} f(k+\delta) \\
    &= S_{\delta}(\sum_{k=x-4}^{x+2} f(k)) \\
    &= S_\delta(\mathcal{F}\left \{f \right\}(x)
\end{align*}
\end{proof}

% d)
\item $\mathcal{F} \left \{ f \right\} (x) = f(2x)$ is $\emph{linear}$ and is $\emph{not shift invariant}$.

\paragraph{Show} $\mathcal{F}$ is \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x)
    &= \alpha f(2x) + \beta g(2x) \\
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is not \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= f(2(x+\delta)) \\
    &= f(2x + 2\delta) \\
    &\neq f(2x + \delta) \\
    &= S_\delta (f(2x)) \\
    &= S_\delta(\mathcal{F}\left \{f \right\}(x)
\end{align*}
\end{proof}


% e)
\item $\mathcal{F} \left \{ f \right\} (x) = \sin(2x)f(x)$ is $\emph{linear}$ and is $\emph{not shift invariant}$.

\paragraph{Show} $\mathcal{F}$ is \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x)
    &= \sin(2x)\left( \alpha f(x) + \beta g(x) \right) \\
    &= \sin(2x) \alpha f(x) + \sin(2x) \beta g(x) \\
    &= \alpha \sin(2x) f(x) + \beta \sin(2x) g(x) \\
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is not \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= \sin(2x)f(x + \delta) \\
    &\neq \sin(2x+\delta)f(x + \delta) \\
    &= S_{\delta} (\sin(2x)f(x)) \\
    &= S_\delta(\mathcal{F}\left \{f \right\}(x)
\end{align*}
\end{proof}


% f)
\item $\mathcal{F} \left \{ f \right\} (x) = x f(x)$ is $\emph{linear}$ and is $\emph{not shift invariant}$.

\paragraph{Show} $\mathcal{F}$ is \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x)
    &= x(\alpha f(x) + \beta f(x)) \\
    &= x \alpha f(x) + x \beta f(x) \\
    &= \alpha x f(x) + \beta x f(x) \\ 
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is not \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= x f(x+\delta) \\
    &\neq (x+\delta)f(x+\delta) \\
    &= S_{\delta} (x f(x)) \\ 
    &= S_\delta(\mathcal{F}\left \{f \right\}(x) 
\end{align*}
\end{proof}

% g)
\item $\mathcal{F} \left \{ f \right\} (x) = f(x) - f(x-5)$ is $\emph{linear}$ and is $\emph{shift invariant}$.

\paragraph{Show} $\mathcal{F}$ is \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x) 
    &= (\alpha f(x) + \beta g(x)) - (\alpha f(x-5) + \beta g(x-5)) \\
    &= (\alpha f(x) - \alpha f(x-5)) + (\beta g(x) - \beta g(x-5)) \\
    &= \alpha(f(x) - f(x-5)) + \beta(g(x) - g(x-5)) \\
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= f(x+\delta) - f(x -5 + \delta) \\
    &= S_{\delta} (f(x) - f(x-5)) \\
    &= S_\delta(\mathcal{F}\left \{f \right\}(x)
\end{align*}
\end{proof}

% h)
\item $\mathcal{F} \left \{ f \right\} (x) = f(x-3)-2f(x-12)$ is $\emph{linear}$ and is $\emph{shift invariant}$.

\paragraph{Show} $\mathcal{F}$ is \emph{linear} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{\alpha f + \beta g \right\}(x) 
    &= (\alpha f(x-3) + \beta g(x-3))-2(\alpha f(x-12) + \beta g(x-12)) \\
    &= (\alpha f(x-3) - 2\alpha f(x-12)) + (\beta g(x-3) - 2\beta g(x-12)) \\
    &= \alpha  (f(x-3) - 2 f(x-12)) + \beta (g(x-3) - 2 g(x-12)) \\
    &= \alpha \mathcal{F} \left \{f\right\}(x) + \beta \mathcal{F} \left \{g \right\}(x)
\end{align*}
\end{proof}

\paragraph{Show} $\mathcal{F}$ is \emph{shift invariant} \\
\begin{proof}
\begin{align*}
    \mathcal{F} \left \{S_\delta (f(x)) \right\} 
    &= \mathcal{F} \left\{ f(x+\delta) \right\} \\
    &= f(x-3 + \delta) - 2f(x-12 + \delta) \\
    &= S_{\delta} (f(x-3)-2f(x-12)) \\
    &= S_\delta(\mathcal{F}\left \{f \right\}(x)
\end{align*}
\end{proof}


\end{enumerate}

    
\section*{Task 2}

Given an $m \times n$ monochromatic (i.e. there is only one color-channel) Image $I$. 
Give an algorithm how to apply box-filtering on this image. Furthermore analyse the asymptotic complexity of this algorithm.

\begin{algorithm}[H]
\caption{Moving Average box filter}
\begin{table}[H]
  \begin{tabular}{@{}lll@{}}
    \textbf{Input:} & Grayscale \emph{Image} I with resolution $m \times n$  \\
    \textbf{Output:} & Box filtered Image \emph{Image} $\hat{I}$   \\
  \end{tabular} 
\end{table}
\textbf{Procedures:} $getDimensions(Image)$, $zeros(height, width)$  \\
\setlength{\fboxrule}{0pt} 
\begin{boxedminipage}{1.0\textwidth}
  \begin{algorithmic}[1]
      \State $ [h,w] = getDimensions(I)$
      \State $ \hat{I} = zeros(h,w)$
      \State $ r = \ceil{\frac{w-1}{2}}$
      \ForAll{$Pixel \thinspace p \in Image \thinspace I$}
        \State $ contribution = 0$
        \ForAll{$Pixel \thinspace p_n \in r-Neighborhood \thinspace \ \mathcal{N}_r(p)$}
            \State $ contribution = contribution + I(p+p_n)$
        \EndFor
        \State $ \hat{I}(p) = \frac{contribution}{m \cdot n}$
      \EndFor
  \end{algorithmic}
  \end{boxedminipage}
  \vskip1.5pt
\label{alg:boxfilter}
\end{algorithm}

\paragraph{Remarks:}

\begin{itemize}
    \item By pixels in the Algorithm $\ref{alg:boxfilter}$ we are referring to the coordinates of the pixel in the image. Therefore $p$ corresponds to the $x$ and $y$ coordinates of pixel $p$ in the Image $I$.
    \item $I(p)$ denotes accessing the pixel-(color)-values in the images at the position of the pixel $p$ in the image $I$.
    \item $\mathcal{N}_r(p)$ denotes the neighborhood with radius $r$ around a given pixel $p$. In the context of pixel-coordinates, think of it as a box-grid, centred at the pixel coordinates of $p$. This grid has a radius of r. This means there are $r$ neighbors (pixel-coordinates in the grid) below, on top, on the left and on the right of $p$.
    \item Our algorithm can easily be extended for color Images by simply applying the same algorithm to each color-channel separately.
    \item The assumption of being provided by a m by n can easily be extended for the case when $n \neq m$. This only will affect the computation of the radius $r$ in algorithm $\ref{alg:boxfilter}$. \\ Computing $\ceil{0.5 \cdot \left( \ceil{\frac{m-1}{2}} + \ceil{\frac{n-1}{2}}\right)}$ would be a valid option in order to compute $r$. 
    \item If $w$ (i.e. n) is odd, then $\ceil{\frac{w-1}{2}}$ is equal to $\frac{w-1}{2}$. 
    \item The procedure $getDimensions$ returns the width-and height resolution of a provided Image.
    \item The procedure $zeros$ creates a new image with the provided resolutions.
\end{itemize}


\paragraph{Aysmptotic Complexity} Next let us have a closer look into algorithm $\ref{alg:boxfilter}$.
\begin{itemize}
    \item The most outer foreach loop will iterate over each pixel. This loop corresponds to two for loops, one over iterating over each row in the image, another iterating over each column in the image. Assuming there are $h$ rows and $w$ columns in the image, this most outer foreach loop has an asymptotic complexity of $\mathcal{O}(h \cdot w)$. From the assignment description we are supposed to assume that there are $m$ pixels in the image. Thus, we conclude, the most outer foreach loop has an asymptotic complexity in $\mathcal{O}(m)$.
    \item The inner foreach loop iterates over each neighorhood pixel around the current pixel in iteration (according the the most outer foreach loop). Assuming we are allowed to ignore boundary issue, we always visit a neighborhood of $\mathcal{O}\left((2r+1\right)^2)$ pixels. Referring to the definition of $r$ at line 3 in algorithm $\label{alg:boxfilter}$ we see that $r$ linearly depends on the width of the image (note that we assume width is equal to height for the given image). Therefore $\mathcal{O}\left((2r+1\right)^2)$ is in the complexity class $\mathcal{O}\left(width^2\right)$. 
\end{itemize}

We can conclude the following: The asymptotic complexity of algorithm $\ref{alg:boxfilter}$ is in $\mathcal{O}\left(k^2 m \right)$. Note that $k$ denotes the width $w$ from before and m is the number of pixels.



\section*{Task 3}
Given a $3 \times 3$ box filter

\begin{equation}
B_{3 \times 3} = 
\frac{1}{9}
\begin{pmatrix}
1 & 1 & 1 \\
1 & 1 & 1 \\
1 & 1 & 1 \\
\end{pmatrix}
\label{eq:box_filter_3x3}
\end{equation}

Applying the boxfilter from equation $\ref{eq:box_filter_3x3}$ twice corresponds to convolving the the box filter with itself, i.e. $B_{3 \times 3} \ast B_{3 \times 3}$. This will gives us the following filter:

\begin{equation}
B_{3 \times 3}^2 = 
\frac{1}{81}
\begin{pmatrix}
1 & 2 & 3 & 2 & 1 \\
2 & 4 & 6 & 4 & 2 \\
3 & 6 & 9 & 6 & 3 \\
2 & 4 & 6 & 4 & 2 \\
1 & 2 & 3 & 2 & 1 \\
\end{pmatrix}
\label{eq:box_filter_3x3_twice}
\end{equation}

In Matlab we can compute $B_{3 \times 3}^2$ applying the function $\emph{conv2}$ to the kernel $B_{3 \times 3}$ with itself, i.e.
\begin{equation}
    B_{3 \times 3}^2 = conv2(B_{3 \times 3},B_{3 \times 3})
\end{equation}

Having a closer look to the filter $B_{3 \times 3}^2$ it resembles a gaussian bell (in 2d). \\ 
 
In spatial domain, the filter $B_{3 \times 3}$ is just a box function (here 2d). In the frequency domain, this corresponds to a $sinc$ function. For simplification, let us consider the one-dimensional box function $rect_T(x)$ which is one if $x$ is in the range $\left[-\frac{T}{2}, \frac{T}{2}\right]$ and zero otherwise.

\begin{equation}
rect_T(x) = \left\{ \begin{array}{rl}
1 &\mbox{ if $ - \frac{T}{2} \leq x \leq \frac{T}{2}$} \\
0 &\mbox{ otherwise}
\end{array} \right.
\end{equation}

Next let us apply the Fourier Transformation on $rect_T(x)$:
\begin{align}
    \int_{\mathbb{R}} rect_T(x) e^{-2j\pi \omega t } dt
    &= \int_{-\frac{T}{2}}^{\frac{T}{2}} e^{-2j\pi \omega t } dt \\
    &= \frac{1}{2 \pi i \omega} [ e^{-2j\pi \omega t } |_{t=-\frac{T}{2}}^{\frac{T}{2}} \\
    &= \frac{1}{2 \pi i  \omega} (e^{-j\pi \omega T} - e^{j\pi \omega T}) \\
    &= \frac{T}{\pi \omega} (\frac{e^{j\pi \omega T} - e^{-j\pi \omega T}}{2j}) \\
    &= \frac{T}{\pi \omega} (\sin(\pi \omega T)) \\
    &= T sinc(\omega T) 
\label{eq:sincderi}
\end{align}

From equation $\ref{eq:sincderi}$ we can conclude a box filter in the frequency domain is equal to a $sinc$ function. Similarly, we can reason when applying a two dimensional box function. Using green's theorem, we can separate a multi-dimensional box function, when applying a Fourier operator (i.e. the n-dimensional Fourier Transformation), since a two dimensional box function is the cartesian product of two one dimensional rect functions. Notice that each of these rect functions only depends on one particular variable (dimension). Thus the integral from equation $\ref{eq:sincderi}$ is separable in the multidimensional case. Therefore, applying the box filter twice corresponds to $rect^2(x,y)$ which is equal to $sinc(u)*sinc(v)$ according to my previous reasoning. Thus, when applying the box function a infinite amount corresponds to the limit of $sinc$ to the power of n, where n converges towards infinite. This converges towards a delta spike function, centred at zero (in the frequency domain). In the spatial domain, however, the function gets wider. Practically speaking, applying the box filter infinite times will average the whole image and  the colors in the image will be everywhere all the same.


\section*{Task 4}
\section*{Task 5}




\section*{Task 6}



\end{document}